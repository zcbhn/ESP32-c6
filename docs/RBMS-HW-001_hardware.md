# RBMS-HW-001: 하드웨어 설계 참조

**문서 번호**: RBMS-HW-001
**프로젝트**: Reptile Breeding Management System (RBMS)
**작성일**: 2026-02-19
**상태**: Draft

---

## 1. 전체 블록 다이어그램

### 1.1 Type A (풀 노드, 콘센트 전원)

```
                         ┌─────────────────────────┐
    5V USB ──────────────┤  AMS1117-3.3            │
    Adapter              │  LDO Regulator           │
                         │  5V → 3.3V               │
                         └────────┬────────────────┘
                                  │ 3.3V
                    ┌─────────────┴──────────────────┐
                    │                                 │
                    │      ESP32-C6-WROOM-1           │
                    │                                 │
                    │   ┌─────────┐  ┌──────────┐   │
                    │   │ I2C     │  │ 1-Wire   │   │
                    │   │ SDA=6   │  │ DATA=8   │   │
                    │   │ SCL=7   │  │          │   │
                    │   └────┬────┘  └────┬─────┘   │
                    │        │            │          │
                    │   ┌────┴────┐  ┌────┴─────┐   │
                    │   │ SHT30   │  │DS18B20 x2│   │
                    │   │ 0x44    │  │핫존/쿨존  │   │
                    │   └─────────┘  └──────────┘   │
                    │                                 │
                    │   ┌────────────────────────┐   │
                    │   │ SSR 제어               │   │
                    │   │ GPIO10 → 2N2222 → SSR0 ├───┼──→ 히터 (AC)
                    │   │ GPIO11 → 2N2222 → SSR1 ├───┼──→ UV조명 (AC)
                    │   └────────────────────────┘   │
                    │                                 │
                    │   ┌────────────────────────┐   │
                    │   │ PWM 디밍               │   │
                    │   │ GPIO3 → IRF520 MOSFET  ├───┼──→ LED Strip (DC)
                    │   └────────────────────────┘   │
                    │                                 │
                    │   ┌────────────────────────┐   │
                    │   │ Thread Radio           │   │
                    │   │ 802.15.4 (내장)         │   │
                    │   │ Role: Router           │   │
                    │   └────────────────────────┘   │
                    │                                 │
                    └─────────────────────────────────┘
```

### 1.2 Type B (배터리 센서 노드)

```
     21700 Li-ion
     (3.0~4.2V)
         │
    ┌────┴────┐
    │ TP4056  │ ← USB-C 충전 입력
    │ 충전 IC  │
    └────┬────┘
         │ VBAT
    ┌────┴────────┐
    │ TPS62740    │
    │ DC-DC Buck  │
    │ IQ=0.36uA  │
    │ 3.3V 출력   │
    └────┬────────┘
         │ 3.3V
    ┌────┴───────────────────────────────────┐
    │                                        │
    │      ESP32-C6-WROOM-1                  │
    │                                        │
    │   ┌────────┐  ┌──────────┐            │
    │   │ I2C    │  │ 1-Wire   │            │
    │   │ SDA=6  │  │ DATA=8   │            │
    │   │ SCL=7  │  │ PWR=9    │ GPIO 전원   │
    │   └───┬────┘  └────┬─────┘ 스위칭     │
    │       │            │                   │
    │   ┌───┴────┐  ┌────┴──────────┐       │
    │   │ SHT30  │  │ DS18B20 x2    │       │
    │   │ 0x44   │  │ GND = BSS138  │       │
    │   └────────┘  │ GPIO9 제어     │       │
    │               └───────────────┘       │
    │                                        │
    │   ┌────────────────────────┐           │
    │   │ 배터리 ADC             │           │
    │   │ GPIO4 ← 분압기        │           │
    │   │ (100k/100k, x2)       │           │
    │   └────────────────────────┘           │
    │                                        │
    │   ┌────────────────────────┐           │
    │   │ Thread Radio           │           │
    │   │ 802.15.4 (내장)         │           │
    │   │ Role: SED              │           │
    │   └────────────────────────┘           │
    │                                        │
    └────────────────────────────────────────┘
```

---

## 2. GPIO 핀맵

### 2.1 ESP32-C6-WROOM-1 핀 할당

| GPIO | Type A 기능 | Type B 기능 | 인터페이스 | 비고 |
|------|-------------|-------------|------------|------|
| GPIO0 | (Boot) | (Boot) | - | 부트 모드 선택 |
| GPIO1 | (UART TX) | (UART TX) | UART | 디버그 시리얼 |
| GPIO2 | (예비) | (예비) | - | - |
| GPIO3 | PWM Dimmer | DS18B20 PWR (Kconfig) | LEDC / GPIO | Type에 따라 다름 |
| GPIO4 | (예비) | Battery ADC | ADC1_CH0 | 분압기 입력 |
| GPIO5 | SSR Light | (예비) | GPIO Output | UV 조명 SSR (Kconfig) |
| GPIO6 | I2C SDA | I2C SDA | I2C | SHT30 데이터 |
| GPIO7 | I2C SCL | I2C SCL | I2C | SHT30 클럭 |
| GPIO8 | DS18B20 DATA | DS18B20 DATA | 1-Wire | 온도 센서 데이터 |
| GPIO9 | (예비) | DS18B20 PWR | GPIO Output | 센서 전원 스위칭 |
| GPIO10 | SSR Heater | (예비) | GPIO Output | 히터 SSR (Kconfig) |
| GPIO11 | (예비/SSR2) | (예비) | GPIO Output | 보조 SSR |
| GPIO12~15 | (예비) | (예비) | - | 확장용 |

> **참고**: GPIO 번호는 Kconfig에서 변경 가능하다. 위 표는 기본 설정 기준이다.

### 2.2 핀맵 요약도

```
ESP32-C6-WROOM-1 핀 배치 (주요 핀만 표시)

          ┌──────────────────────┐
          │                      │
     3V3 ─┤ 1               EN  ├─ EN
     GND ─┤ 2              GND  ├─ GND
  GPIO0  ─┤ 3 (Boot)     GPIO1  ├─ UART TX
  GPIO2  ─┤ 4            GPIO3  ├─ PWM/DS18B20_PWR
  GPIO4  ─┤ 5 (ADC)      GPIO5  ├─ SSR_LIGHT
  GPIO6  ─┤ 6 (SDA)      GPIO7  ├─ (SCL)
  GPIO8  ─┤ 7 (1W DATA)  GPIO9  ├─ DS18B20_PWR
  GPIO10 ─┤ 8 (SSR_HTR)  GPIO11 ├─ (예비)
          │                      │
          │    [802.15.4 ANT]    │
          └──────────────────────┘
```

---

## 3. 전원 설계

### 3.1 Type A 전원 (콘센트 전원)

#### 3.1.1 전원 구조

```
AC 220V → [5V USB Adapter] → [AMS1117-3.3] → 3.3V → ESP32-C6
                                  │
                              C1=10uF (입력)
                              C2=10uF (출력)
```

#### 3.1.2 AMS1117-3.3 LDO

| 항목 | 값 |
|------|-----|
| 입력 전압 | 4.5~12V (5V USB 사용) |
| 출력 전압 | 3.3V (+-1%) |
| 최대 출력 전류 | 1A |
| Dropout 전압 | 1.1V (typ.) |
| 정전류 소모 | ~5mA |
| 입력 커패시터 | 10uF 전해 or 세라믹 |
| 출력 커패시터 | 10uF 전해 or 세라믹 |

#### 3.1.3 전류 소모 예산 (Type A)

| 구성요소 | 평균 전류 | 피크 전류 |
|----------|-----------|-----------|
| ESP32-C6 (Active + Thread) | ~80mA | ~130mA |
| SHT30 | ~0.6mA | ~1.5mA |
| DS18B20 x2 | ~2mA | ~4mA |
| SSR 구동 (2N2222) | ~10mA | ~20mA |
| IRF520 게이트 | ~1mA | ~2mA |
| **합계** | ~94mA | ~158mA |

### 3.2 Type B 전원 (배터리)

#### 3.2.1 전원 구조

```
[21700 Li-ion]    [USB-C 충전]
  3.0~4.2V            5V
      │                │
      └───────┬────────┘
              │
         ┌────┴────┐
         │ TP4056  │
         │ 충전 IC  │
         │ CC/CV   │
         │ 1A max  │
         └────┬────┘
              │ VBAT (3.0~4.2V)
              │
         ┌────┼────────────────────┐
         │    │                    │
    ┌────┴────┐     ┌─────────────┤
    │TPS62740 │     │ 분압기       │
    │ DC-DC   │     │ R1=100k     │
    │ Buck    │     │ R2=100k     │
    │ 3.3V    │     │ VBAT/2      │
    └────┬────┘     └──────┬──────┘
         │                 │
    3.3V → ESP32-C6    GPIO4 (ADC)
```

#### 3.2.2 TP4056 충전 IC

| 항목 | 값 |
|------|-----|
| 충전 전류 | 프로그래머블 (RPROG 저항으로 설정) |
| 충전 전압 | 4.2V (CC/CV) |
| 충전 종료 전류 | 1/10 Ichg |
| 입력 전압 | 4.5~5.5V (USB-C) |
| 과충전 보호 | 내장 |
| 역전류 방지 | DW01A + FS8205A 보호 회로 권장 |

#### 3.2.3 TPS62740 DC-DC Buck Converter

| 항목 | 값 |
|------|-----|
| 입력 전압 | 2.2~5.5V |
| 출력 전압 | 3.3V (VSEL 핀으로 설정) |
| 최대 출력 전류 | 300mA |
| 효율 | >90% (10mA 이상) |
| 정지 전류 (IQ) | 0.36uA (typ.) |
| 스위칭 주파수 | 2.25MHz |
| 인덕터 | 2.2uH (권장) |
| 입력 커패시터 | 10uF 세라믹 |
| 출력 커패시터 | 22uF 세라믹 |

> TPS62740의 극저 정지 전류(0.36uA)는 Deep Sleep 시 배터리 수명에 핵심적이다.
> 일반 LDO(AMS1117: ~5mA)를 사용하면 Deep Sleep 효과가 상쇄된다.

#### 3.2.4 전류 소모 예산 (Type B)

| 상태 | 전류 | 지속 시간 |
|------|------|-----------|
| Deep Sleep (ESP32-C6 + TPS62740) | ~7uA | 30~300초 |
| Wake + 초기화 | ~10mA | ~100ms |
| SHT30 측정 | ~15mA | ~20ms |
| DS18B20 변환 | ~15mA | ~750ms |
| Thread TX | ~15mA | ~200ms |
| Thread 연결 대기 | ~15mA | 최대 5초 |
| 배터리 ADC (30회당 1회) | ~10mA | ~10ms |

---

## 4. 센서 배선

### 4.1 SHT30 I2C 연결

```
          ESP32-C6                     SHT30
         ┌────────┐                  ┌────────┐
    3.3V ┤ 3V3    │                  │ VDD    ├─ 3.3V
         │        │    ┌──┐         │        │
         │ GPIO6  ├────┤  ├─────────┤ SDA    │
         │ (SDA)  │    └──┘  4.7k   │        │
         │        │    ┌──┐ 풀업    │        │
         │ GPIO7  ├────┤  ├─────────┤ SCL    │
         │ (SCL)  │    └──┘  4.7k   │        │
         │        │                  │        │
     GND ┤ GND    │                  │ GND    ├─ GND
         └────────┘                  │        │
                                     │ ADDR   ├─ GND (0x44)
                                     │        │   또는 VDD (0x45)
                                     └────────┘
```

| 항목 | 값 |
|------|-----|
| I2C 주소 | 0x44 (ADDR=GND) 또는 0x45 (ADDR=VDD) |
| 버스 속도 | 400kHz (Fast Mode) |
| 풀업 저항 | 4.7k (SDA, SCL 각각) |
| 전원 | 2.15~5.5V (3.3V 사용) |
| 바이패스 커패시터 | 100nF (VDD-GND, 센서 근처) |

### 4.2 DS18B20 1-Wire 연결

#### 4.2.1 Type A (상시 전원)

```
          ESP32-C6                DS18B20 #0 (핫존)    DS18B20 #1 (쿨존)
         ┌────────┐              ┌──────────┐         ┌──────────┐
    3.3V ┤        │        ┌──┐ │ VDD      ├─ 3.3V   │ VDD      ├─ 3.3V
         │        │    ┌───┤  ├─┤          │         │          │
         │ GPIO8  ├────┤   └──┘ │ DQ       │─────────┤ DQ       │
         │ (DATA) │    │  4.7k  │          │  (병렬) │          │
         │        │    │  풀업  │ GND      ├─ GND    │ GND      ├─ GND
     GND ┤ GND    │    │        └──────────┘         └──────────┘
         └────────┘    │
                       └── 3.3V
```

#### 4.2.2 Type B (GPIO 전원 스위칭)

```
          ESP32-C6
         ┌────────┐
         │ GPIO9  ├────────────────────────────┐
         │ (PWR)  │                            │
         │        │    ┌──┐                ┌───┴───┐
    3.3V ┤        │┌───┤  ├────────┐       │BSS138 │
         │ GPIO8  ├┤   └──┘ 4.7k  │       │N-MOSFET│
         │ (DATA) ││              │       │       │
         └────────┘│   ┌──────────┤       └───┬───┘
                   │   │DS18B20 #0│           │
                   ├───┤ DQ       │           │
                   │   │ VDD ─ 3.3V           │
                   │   │ GND ─────────────────┘ (스위칭 GND)
                   │   └──────────┘
                   │   ┌──────────┐
                   └───┤DS18B20 #1│
                       │ DQ       │
                       │ VDD ─ 3.3V
                       │ GND ─────────────────── (스위칭 GND)
                       └──────────┘
```

- **BSS138**: N-channel MOSFET, GPIO9 HIGH → GND 연결 → 센서 동작
- GPIO9 LOW → GND 차단 → 센서 비활성 (누설 전류 차단)
- Deep Sleep 중 GPIO9를 LOW hold하여 센서 전원 완전 차단

| 항목 | 값 |
|------|-----|
| 데이터 핀 | GPIO8 (1-Wire, 오픈 드레인) |
| 풀업 저항 | 4.7k (DATA → VDD) |
| 전원 제어 | GPIO9 → BSS138 → GND (Type B) |
| 해상도 | 12비트 (기본) |
| 변환 시간 | 750ms (12비트) |
| 기생 전원 | 미사용 (외부 VDD 전원) |
| 케이블 | 방수 프로브 타입 권장 (사육장 환경) |

---

## 5. 제어부 회로

### 5.1 SSR 구동 회로 (Type A)

```
         ESP32-C6                 2N2222A                G3MB-202P SSR
        ┌────────┐              ┌───────┐              ┌──────────┐
        │        │     1k       │       │              │          │
        │ GPIO10 ├───/\/\/──────┤ B   C ├──────────────┤ + (DC)   │
        │        │              │       │     3.3V ────┤ - (DC)   │
        │        │              │   E   │              │          │
        │        │              └───┬───┘              │ AC1      ├──→ AC 부하 (히터)
        │        │                  │                  │ AC2      ├──→ AC N
        │        │                 GND                 └──────────┘
        └────────┘

        (GPIO11 → SSR1 동일 구성, UV 조명용)
```

#### 5.1.1 SSR G3MB-202P 사양

| 항목 | 값 |
|------|-----|
| 제어 입력 | 3~32V DC |
| 부하 전압 | 75~264V AC |
| 부하 전류 | 최대 2A |
| 트리거 전류 | ~7.5mA (5V 기준) |
| Zero-cross | 내장 |

#### 5.1.2 2N2222A 바이퍼 트랜지스터

- **목적**: ESP32-C6 GPIO 출력(3.3V, 최대 40mA)으로 SSR를 안정적으로 구동
- **베이스 저항**: 1k (Ib = (3.3 - 0.7) / 1000 = 2.6mA)
- **컬렉터 전류**: SSR 입력 전류 (~7.5mA)
- **포화 조건**: hFE >= 3 (2N2222A hFE 최소 75이므로 충분)

#### 5.1.3 Cycle Skipping 동작

```
10초 주기 (100 ticks x 100ms)

duty = 40% 예시:

tick:  0   10  20  30  39  40  50  60  70  80  90  99
GPIO: [====ON==========][==========OFF=============]
       40 ticks ON        60 ticks OFF
```

- 10초 주기에서 duty% 시간만큼 SSR ON
- Zero-cross SSR이므로 AC 파형의 영점에서 ON/OFF
- 기계식 릴레이 대비 수명 무제한, 무소음

### 5.2 PWM LED 디밍 회로 (Type A)

```
         ESP32-C6                 IRF520 MOSFET          LED Strip
        ┌────────┐              ┌───────────┐          ┌──────────┐
        │        │     10k      │           │          │          │
        │ GPIO3  ├───/\/\/──┬───┤ G       D ├──────────┤ - (LED)  │
        │        │          │   │           │          │          │
        │        │       10k│   │       S   │     12V ─┤ + (LED)  │
        │        │          │   └───────┬───┘          └──────────┘
        │        │         GND          │
        │        │                     GND
        └────────┘
```

#### 5.2.1 IRF520 MOSFET 사양

| 항목 | 값 |
|------|-----|
| 타입 | N-channel Enhancement |
| VGS(th) | 2~4V |
| VDS(max) | 100V |
| ID(max) | 9.2A |
| RDS(on) | 0.27 ohm (VGS=10V) |
| 게이트 전류 | ~0 (MOSFET) |

> **주의**: IRF520의 VGS(th)는 2~4V로, ESP32-C6의 3.3V GPIO로는 완전 포화가 어려울 수 있다.
> 대전류 LED(>1A) 사용 시 Logic-level MOSFET (IRLZ44N, VGS(th)=1~2V) 권장.

#### 5.2.2 PWM 사양

| 항목 | 값 |
|------|-----|
| 주파수 | 1kHz |
| 해상도 | 10-bit (0~1023) |
| 클럭 | XTAL_CLK (40MHz) |
| 사용자 범위 | 0~1000 (brightness 단위) |
| 변환 공식 | `duty = brightness * 1023 / 1000` |
| 페이드 | LEDC fade 기능 (일출/일몰 시뮬레이션) |

#### 5.2.3 게이트 보호

- **게이트-소스 풀다운**: 10k (부팅 시 LED 오동작 방지)
- **게이트 직렬 저항**: 10k (오실레이션 방지, 슬루레이트 제한)
- Deep Sleep 중 GPIO3 LOW hold → LED 강제 소등

---

## 6. 배터리 모니터링 회로 (Type B)

### 6.1 분압기 회로

```
    VBAT (3.0~4.2V)
         │
        ┌┴┐
        │ │ R1 = 100k
        │ │
        └┬┘
         ├──────── GPIO4 (ADC1_CH0) ─── ESP32-C6
        ┌┴┐
        │ │ R2 = 100k
        │ │
        └┬┘
         │
        GND
```

### 6.2 분압기 계산

```
V_adc = VBAT * R2 / (R1 + R2) = VBAT * 100k / 200k = VBAT / 2

VBAT = 4.2V → V_adc = 2.1V  (ADC 범위 내)
VBAT = 3.0V → V_adc = 1.5V  (ADC 범위 내)
```

### 6.3 ADC 설정

| 항목 | 값 |
|------|-----|
| ADC 유닛 | ADC_UNIT_1 |
| 채널 | ADC_CHANNEL_0 (GPIO4) |
| 감쇠 | ADC_ATTEN_DB_12 (0~3.3V 입력) |
| 비트폭 | 12-bit (0~4095) |
| 멀티샘플링 | 16회 평균 (노이즈 4배 감소) |
| 캘리브레이션 | Curve Fitting (ESP32-C6 전용) |
| 분압비 보정 | x2 |

### 6.4 전압-잔량 변환

```
전압 (mV)   →   잔량 (%)
 4200       →   100%
 3000       →     0%
 중간값     →   선형 보간: (V - 3000) * 100 / (4200 - 3000)

저전압 경고: V < 3200mV
```

### 6.5 분압기 누설 전류

```
I_leak = VBAT / (R1 + R2) = 4.2V / 200k = 21uA
```

> Deep Sleep 중에도 분압기를 통해 21uA가 흐른다. 이를 줄이려면:
> - R1/R2를 1M/1M으로 변경 (누설 2.1uA, 정확도 저하 가능)
> - P-MOSFET으로 분압기 전원 스위칭 추가

### 6.6 배터리 측정 주기

- 매 폴링마다 측정하지 않고 `BATTERY_CHECK_INTERVAL` (기본 30) 회마다 1회 측정
- 첫 부팅 시에는 항상 측정
- 측정 후 ADC 해제 (`battery_monitor_deinit()`) 하여 전력 절약

---

## 7. BOM (부품 목록)

### 7.1 공통 부품

| 부품 | 규격 | 수량 | 용도 | 비고 |
|------|------|------|------|------|
| ESP32-C6-WROOM-1 | 4MB Flash | 1 | MCU | DevKitC-1 보드 또는 모듈 |
| SHT30 | DFN 2.5x2.5mm | 1 | 온습도 센서 | 브레이크아웃 보드 가능 |
| DS18B20 | TO-92 또는 방수 프로브 | 2 | 온도 센서 (핫/쿨존) | 방수 프로브 권장 |
| 4.7k 저항 | 0603 | 3 | I2C 풀업(x2), 1-Wire 풀업(x1) | 1/4W |
| 100nF 세라믹 | 0603 | 3 | 바이패스 (SHT30, MCU, DC-DC) | X7R |

### 7.2 Type A 전용 부품

| 부품 | 규격 | 수량 | 용도 | 비고 |
|------|------|------|------|------|
| AMS1117-3.3 | SOT-223 | 1 | 5V→3.3V LDO | |
| 10uF 전해 | 16V | 2 | LDO 입출력 커패시터 | 세라믹 대체 가능 |
| G3MB-202P | SSR | 2 | 히터/UV 제어 | AC 2A |
| 2N2222A | TO-92 | 2 | SSR 구동 버퍼 | NPN |
| 1k 저항 | 0603 | 2 | 트랜지스터 베이스 저항 | 1/4W |
| IRF520 | TO-220 | 1 | LED 디밍 MOSFET | N-ch |
| 10k 저항 | 0603 | 2 | MOSFET 게이트 풀다운/직렬 | 1/4W |
| 5V USB Adapter | 1A+ | 1 | 전원 공급 | |

### 7.3 Type B 전용 부품

| 부품 | 규격 | 수량 | 용도 | 비고 |
|------|------|------|------|------|
| 21700 Li-ion | 5000mAh | 1 | 배터리 | 보호 회로 내장 권장 |
| TP4056 | DIP-8 / 모듈 | 1 | 충전 IC | USB-C 입력 |
| DW01A + FS8205A | - | 1 set | 배터리 보호 | 과방전/과충전/단락 |
| TPS62740 | WSON-12 | 1 | DC-DC Buck | IQ 0.36uA |
| 2.2uH 인덕터 | 3x3mm | 1 | TPS62740 인덕터 | 1A 이상 |
| 10uF 세라믹 | 0402/0603 | 1 | DC-DC 입력 커패시터 | X5R |
| 22uF 세라믹 | 0603 | 1 | DC-DC 출력 커패시터 | X5R |
| BSS138 | SOT-23 | 1 | DS18B20 GND 스위칭 | N-ch MOSFET |
| 100k 저항 | 0603 | 2 | 배터리 분압기 (R1, R2) | 1% 정밀 |
| 21700 홀더 | - | 1 | 배터리 장착 | 스프링 타입 |

---

## 8. PCB 설계 고려사항

### 8.1 레이아웃 가이드라인

#### 8.1.1 일반 규칙

- **2-layer PCB** 권장 (비용 절감, 충분한 복잡도)
- **그라운드 플레인**: 하면(Bottom) 전체를 GND로 채움 (노이즈 저감)
- **전원 트레이스**: 최소 0.5mm 폭 (3.3V, VBAT 라인)
- **신호 트레이스**: 0.2~0.3mm 폭 (I2C, 1-Wire, GPIO)
- **비아**: 0.3mm 드릴, 0.6mm 패드

#### 8.1.2 안테나 영역

- **ESP32-C6-WROOM-1 안테나**: PCB 가장자리에 배치
- 안테나 아래 **구리 제거 영역 (Keep-Out Zone)** 확보
- Espressif 안테나 설계 가이드라인 준수 (최소 15mm x 15mm 클리어런스)
- 금속 케이스 사용 시 외부 안테나 고려

#### 8.1.3 DC-DC 배치 (Type B)

- TPS62740 → 인덕터 → 출력 커패시터를 **최대한 밀착 배치**
- 스위칭 노드 트레이스 면적 최소화 (EMI 저감)
- 입력/출력 커패시터는 IC 핀에 직접 연결
- GND 비아를 IC 패드 바로 아래에 배치

### 8.2 기구 설계

#### 8.2.1 케이스 재질

- **Type A**: ABS 사출 또는 3D 프린트 (PLA/PETG)
  - 환기 슬릿 필수 (LDO/SSR 발열)
  - 방수 등급 불필요 (사육장 외부 설치)
- **Type B**: 3D 프린트 (PETG 권장)
  - 배터리 도어 설계
  - USB-C 충전 포트 개구부
  - 센서 케이블 관통 구멍 (실리콘 씰링)

#### 8.2.2 크기 목표

| 타입 | 목표 크기 | 비고 |
|------|-----------|------|
| Type A | 80 x 50 x 25mm | SSR 모듈 외장 |
| Type B | 60 x 40 x 20mm | 배터리 홀더 포함 |

### 8.3 열 관리

#### 8.3.1 Type A 발열 요소

| 부품 | 발열량 | 대책 |
|------|--------|------|
| AMS1117-3.3 | (5V-3.3V) x 100mA = 170mW | SOT-223 써멀 패드, 구리 방열 |
| SSR G3MB-202P | ~0.5W (2A 부하 시) | 별도 방열판 또는 외장 |

#### 8.3.2 Type B 발열 요소

- 전력 소모가 극히 적어 별도 방열 불필요
- TPS62740 효율 90% 이상 → 발열 무시 가능

### 8.4 센서 배치 권장 사항

| 센서 | 배치 위치 | 주의 |
|------|-----------|------|
| SHT30 | PCB 위, 발열 부품에서 격리 | 공기 순환 슬릿 필요 |
| DS18B20 #0 (핫존) | 히터 근처, 방수 프로브 | 프로브 케이블 30~50cm |
| DS18B20 #1 (쿨존) | 히터 반대편, 방수 프로브 | 프로브 케이블 30~50cm |

> SHT30은 PCB 발열 영향을 받을 수 있으므로, 가능하면 별도 소기판이나
> 브레이크아웃 보드를 사용하여 물리적으로 분리하는 것을 권장한다.

### 8.5 ESD 보호

- 외부 노출 커넥터 (USB, 센서 프로브)에 TVS 다이오드 권장
- 1-Wire 라인: 3.3V TVS (예: PESD3V3L1BA)
- I2C 라인: 3.3V TVS (SDA, SCL 각각)

---

## 9. 회로도 파일 목록

프로젝트의 `docs/schematics/` 디렉토리에 SVG 형식으로 회로도가 제공된다.

| 파일명 | 내용 |
|--------|------|
| `1_type_b_power.svg` | Type B 전원부 (배터리 → TP4056 → TPS62740 → 3.3V) |
| `2_type_b_i2c.svg` | Type B I2C 연결 (SHT30 + 풀업) |
| `3_type_b_1wire.svg` | Type B 1-Wire 연결 (DS18B20 x2 + BSS138 GND 스위칭) |
| `4_type_a_control.svg` | Type A 제어부 (SSR + 2N2222 버퍼 + MOSFET PWM) |
| `5_type_b_adc.svg` | Type B ADC (배터리 모니터링 분압기) |

---

## 10. 커넥터 및 인터페이스

### 10.1 센서 커넥터

| 커넥터 | 핀 수 | 핀 배치 | 용도 |
|--------|--------|---------|------|
| JST-XH 4P | 4 | VCC, SDA, SCL, GND | SHT30 I2C |
| JST-XH 3P | 3 | VCC, DATA, GND | DS18B20 x2 (병렬) |

### 10.2 전원 커넥터

| 커넥터 | 타입 | 용도 |
|--------|------|------|
| USB-C | 충전/전원 | Type A: 5V 전원, Type B: 배터리 충전 |
| 스크류 터미널 2P | AC 출력 | SSR → 히터/UV 부하 (Type A) |
| DC 배럴잭 2.1mm | 12V 입력 | LED Strip 전원 (Type A, 옵션) |

### 10.3 프로그래밍/디버그

| 인터페이스 | 핀 | 용도 |
|------------|-----|------|
| UART | TX=GPIO1 | 시리얼 모니터, 펌웨어 플래시 |
| USB-JTAG | 내장 | JTAG 디버깅 (ESP32-C6 내장) |

---

## 11. 참고 데이터시트

| 부품 | 제조사 | 주요 참고 |
|------|--------|-----------|
| ESP32-C6-WROOM-1 | Espressif | 핀 배치, 전기적 특성, 안테나 |
| SHT30-DIS | Sensirion | I2C 프로토콜, CRC, 정확도 |
| DS18B20 | Maxim/Analog Devices | 1-Wire 타이밍, Scratchpad 구조 |
| AMS1117-3.3 | AMS | Dropout, 열 특성, 커패시터 |
| G3MB-202P | Omron | 입력 전류, 영점 교차, 정격 |
| IRF520 | IR/Infineon | VGS(th), RDS(on), SOA |
| TP4056 | NanJing Top Power | 충전 프로파일, RPROG 설정 |
| TPS62740 | Texas Instruments | VSEL 설정, 효율 곡선, PCB 레이아웃 |
| BSS138 | ON Semiconductor | VGS(th), RDS(on), SOT-23 |
| DW01A | Fortune Semiconductor | 과방전/과충전 설정 전압 |
| 2N2222A | ON/STMicro | hFE, VCE(sat), 포화 조건 |
