# RBMS Mosquitto MQTT Broker Configuration
# Linux 서버용

# 기본 리스너 (LAN 내 통신)
listener 1883 0.0.0.0
protocol mqtt

# TLS 리스너 (인증서 설정 후 아래 주석 해제)
# listener 8883 0.0.0.0
# protocol mqtt
# cafile /opt/rbms/certs/ca.pem
# certfile /opt/rbms/certs/mqtt-server.pem
# keyfile /opt/rbms/certs/mqtt-server-key.pem
# tls_version tlsv1.2

# 인증
allow_anonymous false
password_file /etc/mosquitto/passwd

# ACL
acl_file /etc/mosquitto/acl.conf

# 로깅
log_dest file /var/log/mosquitto/mosquitto.log
log_type warning
log_type error
log_type notice
log_timestamp true
log_timestamp_format %Y-%m-%dT%H:%M:%S

# 연결 유지
max_keepalive 120
persistent_client_expiration 7d

# 성능
max_inflight_messages 20
max_queued_messages 1000

# Retained 메시지 (프리셋 배포용)
retain_available true

# 메시지 크기 제한 (CBOR 패킷은 작음)
message_size_limit 4096
